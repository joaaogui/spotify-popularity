import{h as n,s as o}from"./index-1b973670.js";const i=n.create({baseURL:"https://api.spotify.com/v1/",headers:{Authorization:`Bearer ${o.state.token}`}}),m=t=>i.get(`search?q=${t}&type=artist`),l=(t,a)=>i.get(`artists/${t}/albums?offset=${a}&limit=50&include_groups=album,single`),h=t=>i.get(`albums/?ids=${t}`),u=t=>i.get(`tracks/?ids=${t}`),d=async t=>{o.commit("setInput",t);try{const a=await m(t);await p(a.data.artists.items[0].id)}catch(a){throw new Error(a)}},p=async t=>{let a=[];try{let s=0,e=await l(t,s);for(a.push(...e.data.items);e.data.next!==null;)s+=50,e=await l(t,s),a.push(...e.data.items);await w(a.map(r=>r.id))}catch(s){throw new Error(s)}},w=async t=>{let a=[];try{let s=0,e=20;for(;e<=t.length;){const r=await h(t.slice(s,e));s=e+1,e+=20,a.push(...r.data.albums.map(c=>c.tracks.items))}await g(a.map(r=>r.map(c=>c.id)).flat())}catch(s){throw new Error(s)}},g=async t=>{let a=[];try{let s=0,e=50;for(;e<=t.length+50;){const r=await u(t.slice(s,e));s=e+1,e+=50,a.push(...r.data.tracks)}o.commit("setTracks",a.sort((r,c)=>r.popularity<c.popularity?1:-1))}catch(s){throw new Error(s)}};export{d as searchArtist};
